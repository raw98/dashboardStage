function d33(e,t,a,n,o){const r=d3.select("svg"),l=r.attr("height"),s=(d3.geoPath(),d3.map());worldmap="https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson";var c=[];let i;var d=document.querySelector(".my_dataviz").style.width.replace("vw","");const p=d3.geoRobinson().scale(130).translate([d/2,l/2]),u=d3.scaleThreshold().domain([1e5,1e6,1e7,3e7,1e8,5e8]).range(d3.schemeOrRd[7]),g=d3.select("body").append("div").attr("class","tooltip").style("background-color","white").style("padding-right","10px").style("padding-left","10px").style("opacity",0);function y(t,a){console.log("new config");i=r.append("g").attr("class","world"),i.selectAll("path").data(a.features).enter().append("path").attr("d",d3.geoPath().projection(p)).attr("data-name",function(e){return e.properties.name}).attr("fill",function(e){return e.total=s.get(e.id)||0,u(e.total)}).style("stroke","transparent").attr("class",function(e){return"Country"}).attr("id",function(e){return e.id}).style("opacity",1).on("mouseover",function(e){d3.selectAll(".Country").transition().duration(200).style("opacity",.5).style("stroke","transparent"),d3.select(this).transition().duration(200).style("opacity",1).style("stroke","black"),g.style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY-28+"px").transition().duration(400).style("opacity",1).text(e.properties.name+": "+Math.round(e.total/1e6*10)/10+" mio.")}).on("mouseleave",function(){d3.selectAll(".Country").transition().duration(200).style("opacity",1).style("stroke","transparent"),g.transition().duration(300).style("opacity",0)}),"none"!==n&&(console.log(n),console.log("world1 : "+JSON.stringify(i)),i.selectAll("world.node").select("g").remove(),console.log("world2 : "+JSON.stringify(i)),e.getLocalisation(n).subscribe(e=>{e.forEach(e=>{c.push({lon:e.lon,lat:e.lat}),console.log(e.name)}),console.log("markerData: "+JSON.stringify(c));var t=i.selectAll("world.node").data(c).enter().append("g").attr("class","node").attr("transform",function(e){return console.log(p([e.lon,e.lat])[0]+","+p([e.lon,e.lat])[1]),"translate("+p([e.lon,e.lat])[0]+","+p([e.lon,e.lat])[1]+")"});t.append("path").attr("d","M16,0C9.382,0,4,5.316,4,12.001c0,7,6.001,14.161,10.376,19.194   C14.392,31.215,15.094,32,15.962,32c0.002,0,0.073,0,0.077,0c0.867,0,1.57-0.785,1.586-0.805   c4.377-5.033,10.377-12.193,10.377-19.194C28.002,5.316,22.619,0,16,0z M16.117,29.883c-0.021,0.02-0.082,0.064-0.135,0.098   c-0.01-0.027-0.084-0.086-0.129-0.133C12.188,25.631,6,18.514,6,12.001C6,6.487,10.487,2,16,2c5.516,0,10.002,4.487,10.002,10.002   C26.002,18.514,19.814,25.631,16.117,29.883z").attr("fillrule","evenodd").attr("cliprule","evenodd").attr("fill","#333333"),t.append("path").attr("d","M16.002,17.746c3.309,0,6-2.692,6-6s-2.691-6-6-6   c-3.309,0-6,2.691-6,6S12.693,17.746,16.002,17.746z M16.002,6.746c2.758,0,5,2.242,5,5s-2.242,5-5,5c-2.758,0-5-2.242-5-5   S13.244,6.746,16.002,6.746z").attr("fillrule","evenodd").attr("cliprule","evenodd").attr("fill","#333333"),console.log(t)}))}o.filters.subscribe(t=>{let a="none",n="none",o=0,r=0,l="none",c="none",i="none",d="none",p="none";t.forEach(t=>{switch(t.filter){case"continent":a=t.element;break;case"region":n=t.element;break;case"year":o=Number(t.element);break;case"week":r=Number(t.element);break;case"day":l=t.element;break;case"article":c=t.element;break;case"fournisseur":d=t.element;break;case"client":i=t.element;break;case"magazin":p=t.element}e.getData(o).subscribe(e=>{worldpopulation="https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.csv",function(e){e.forEach(e=>{s.set(e.code,e.vente)})}(e),d3.queue().defer(d3.json,worldmap).await(y)})})}),r.append("rect").attr("class","background").attr("width","0").attr("height",l)}