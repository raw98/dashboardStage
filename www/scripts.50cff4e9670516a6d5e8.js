function d33(){const t=d3.select("svg"),e=t.attr("width"),n=t.attr("height"),a=d3.geoPath(),r=d3.map();let o,l;const s=d3.geoRobinson().scale(130).translate([e/2,n/2]),i=d3.scaleThreshold().domain([1e5,1e6,1e7,3e7,1e8,5e8]).range(d3.schemeOrRd[7]),d=d3.select("body").append("div").attr("class","tooltip").style("background-color","white").style("padding-right","10px").style("padding-left","10px").style("opacity",0);d3.queue().defer(d3.json,"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson").defer(d3.csv,"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.csv",function(t){r.set(t.code,+t.pop)}).await(function(e,a){l=t.append("g").attr("class","world"),l.selectAll("path").data(a.features).enter().append("path").attr("d",d3.geoPath().projection(s)).attr("data-name",function(t){return t.properties.name}).attr("fill",function(t){return t.total=r.get(t.id)||0,i(t.total)}).style("stroke","transparent").attr("class",function(t){return"Country"}).attr("id",function(t){return t.id}).style("opacity",1).on("mouseover",function(t){d3.selectAll(".Country").transition().duration(200).style("opacity",.5).style("stroke","transparent"),d3.select(this).transition().duration(200).style("opacity",1).style("stroke","black"),d.style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY-28+"px").transition().duration(400).style("opacity",1).text(t.properties.name+": "+Math.round(t.total/1e6*10)/10+" mio.")}).on("mouseleave",function(){d3.selectAll(".Country").transition().duration(200).style("opacity",1).style("stroke","transparent"),d.transition().duration(300).style("opacity",0)});const o=d3.scaleLinear().domain([2.6,75.1]).rangeRound([600,860]),c=t.append("g").attr("id","legend"),p=c.selectAll("g.legend").data(i.range().map(function(t){return null==(t=i.invertExtent(t))[0]&&(t[0]=o.domain()[0]),null==t[1]&&(t[1]=o.domain()[1]),t})).enter().append("g").attr("class","legend_entry");p.append("rect").attr("x",20).attr("y",function(t,e){return n-20*e-40}).attr("width",20).attr("height",20).style("fill",function(t){return i(t[0])}).style("opacity",.8),p.append("text").attr("x",50).attr("y",function(t,e){return n-20*e-20-6}).text(function(t,e){return 0===e?"< "+t[1]/1e6+" m":t[1]<t[0]?t[0]/1e6+" m +":t[0]/1e6+" m - "+t[1]/1e6+" m"}),c.append("text").attr("x",15).attr("y",280).text("vente (Million \xa3)")}),t.append("rect").attr("class","background").attr("width","0").attr("height",n).on("click",function(t){var e,n,r;if(t&&o!==t){var s=a.centroid(t);e=-6*s[0],n=6*s[1],r=3,o=t}else e=0,n=0,r=1,o=null;l.selectAll("path").classed("active",o&&function(t){return t===o}),l.transition().duration(750).attr("transform","translate("+e+","+n+") scale("+r+")")})}